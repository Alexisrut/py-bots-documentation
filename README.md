<h1>Бот для создания открузок</h1>
<h2>Описание</h2>
<p>Этот Telegram бот представляет собой инструмент для обработки и загрузки файлов с информацией о товарах в систему "Мой склад". Бот позволяет загружать таблицы в формате Excel (XLSX) или PDF, а затем автоматически обрабатывает их, создавая соответствующие записи в системе "Мой склад".</p>
<h2>Использование</h2>
<p>
<ul>
  <p><li>Старт бота: Для начала работы с ботом отправьте команду /start.</li></p>
  <p><li>Загрузка таблицы соответствия: Вы можете загрузить новую таблицу, содержащую информацию о соответствии товаров, с помощью кнопки "Загрузить таблицу соответствия". Это позволяет обновлять данные, которые использует бот для соответствия товаров в загружаемых файлах.</li></p>
  <p><li>Получение текущей таблицы соответствия: При необходимости можно получить текущую таблицу соответствия, которую использует бот, с помощью кнопки "Получить текущую таблицу соответствия".</li></p>
  <p><li>Форматирование файла для "Мой склад": После загрузки файла с информацией о товарах, бот автоматически обрабатывает его. Для файлов в формате XLSX бот создает записи о товарах в системе "Мой склад" на основе данных из файла. Для файлов в формате PDF бот производит предварительную обработку, удаляя каждую вторую страницу, а затем создает записи о товарах в системе "Мой склад" на основе данных из файла.</li></p>
</ul>
</p>
<h2>Функции</h2>
<p>Ниже перечислены основные функции, выполняемые ботом:</p>
<ul>
    <li><strong>create_gain_xlsx(file_name):</strong> Создает отгрузку на основе данных из файла в формате XLSX.</li>
    <li><strong>create_gain_pdf(file_name):</strong> Создает отгрузку на основе данных из файла в формате PDF.</li>
    <li><strong>remove_every_other_page(pdf_path):</strong> Удаляет каждую вторую страницу из PDF-файла.</li>
    <li><strong>get_file_format(file_path):</strong> Определяет формат файла на основе его MIME-типа.</li>
    <li><strong>get_positions(items):</strong> Формирует данные о позициях товаров для отгрузки.</li>
    <li><strong>detect_file_type(file_path):</strong> Определяет тип файла на основе его MIME-типа.</li>
</ul>

<h2>Запуск бота</h2>
<p>Для запуска бота используйте функцию <code>bot.polling(none_stop=True)</code>. Этот метод запускает процесс обработки входящих сообщений и ожидает новых событий от Telegram API, обеспечивая беспрерывную работу бота.</p>

<h2>Обработка ошибок</h2>
<p>В случае возникновения ошибок, связанных с соединением или обработкой данных, бот переходит в режим ожидания и пытается повторно подключиться. Это обеспечивает устойчивую работу бота даже в условиях временных сбоев в сети или при обработке некорректных данных.</p>
